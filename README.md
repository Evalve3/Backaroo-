# Backaroo-

Crowdfunding platform created for me to learn fastapi

env file
```env
DATABASE_USERNAME=
DATABASE_PASSWORD=
DATABASE_PORT=
DATABASE_HOSTNAME=
DATABASE_NAME=
ACCESS_TOKEN_EXPIRE_MINUTES= (если не указать - будет значение по умолчанию)
SECRET_KEY= (если не указать - будет значение по умолчанию)
JWT_ALGORITHM= (если не указать - будет значение по умолчанию)
```

Для накатывания миграций, если файла alembic.ini ещё нет, нужно запустить в терминале команду:

```
alembic init migrations
```
После этого будет создана папка с миграциями и конфигурационный файл для алембика.
- В alembic.ini нужно задать адрес базы данных, в которую будем катать миграции (драйвер не асинк указываем, просто psycopg2).
- Дальше идём в папку с миграциями и открываем env.py, там вносим изменения в блок, где написано
```
from myapp import mymodel
```
- Дальше вводим: ```alembic revision --autogenerate -m "comment"``` - делается при любых изменениях моделей
- Будет создана миграция
- Дальше вводим: ```alembic upgrade heads```


Для того, чтобы во время тестов нормально генерировались миграции нужно:
- сначала попробовать запустить тесты обычным образом. с первого раза все должно упасть
- если после падения в папке tests создались алембиковские файлы, то нужно прописать туда данные по миграхам
- если они не создались, то зайти из консоли в папку test и вызвать вручную команды на миграции, чтобы файлы появилисьсоли в папку test и вызвать вручную команды на миграции, чтобы файлы появились
